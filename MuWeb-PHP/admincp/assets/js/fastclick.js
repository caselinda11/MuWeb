(function(){function g(n,q){var p;q=q||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=q.touchBoundary||10;this.layer=n;this.tapDelay=q.tapDelay||200;this.tapTimeout=q.tapTimeout||700;if(g.notNeeded(n)){return}function h(l,i){return function(){return l.apply(i,arguments)}}var o=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];var j=this;for(var k=0,m=o.length;k<m;k++){j[o[k]]=h(j[o[k]],j)}if(a){n.addEventListener("mouseover",this.onMouse,true);n.addEventListener("mousedown",this.onMouse,true);n.addEventListener("mouseup",this.onMouse,true)}n.addEventListener("click",this.onClick,true);n.addEventListener("touchstart",this.onTouchStart,false);n.addEventListener("touchmove",this.onTouchMove,false);n.addEventListener("touchend",this.onTouchEnd,false);n.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){n.removeEventListener=function(s,i,l){var r=Node.prototype.removeEventListener;if(s==="click"){r.call(n,s,i.hijacked||i,l)}else{r.call(n,s,i,l)}};n.addEventListener=function(s,l,r){var i=Node.prototype.addEventListener;if(s==="click"){i.call(n,s,l.hijacked||(l.hijacked=function(t){if(!t.propagationStopped){l(t)}}),r)}else{i.call(n,s,l,r)}}}if(typeof n.onclick==="function"){p=n.onclick;n.addEventListener("click",function(i){p(i)},false);n.onclick=null}}var f=navigator.userAgent.indexOf("Windows Phone")>=0;var a=navigator.userAgent.indexOf("Android")>0&&!f;var c=/iP(ad|hone|od)/.test(navigator.userAgent)&&!f;var d=c&&(/OS 4_\d(_\d)?/).test(navigator.userAgent);var e=c&&(/OS [6-7]_\d/).test(navigator.userAgent);var b=navigator.userAgent.indexOf("BB10")>0;g.prototype.needsClick=function(h){switch(h.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(h.disabled){return true}break;case"input":if((c&&h.type==="file")||h.disabled){return true}break;case"label":case"iframe":case"video":return true}return(/\bneedsclick\b/).test(h.className)};g.prototype.needsFocus=function(h){switch(h.nodeName.toLowerCase()){case"textarea":return true;case"select":return !a;case"input":switch(h.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return !h.disabled&&!h.readOnly;default:return(/\bneedsfocus\b/).test(h.className)}};g.prototype.sendClick=function(j,i){var h,k;if(document.activeElement&&document.activeElement!==j){document.activeElement.blur()}k=i.changedTouches[0];h=document.createEvent("MouseEvents");h.initMouseEvent(this.determineEventType(j),true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);h.forwardedTouchEvent=true;j.dispatchEvent(h)};g.prototype.determineEventType=function(h){if(a&&h.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};g.prototype.focus=function(i){var h;if(c&&i.setSelectionRange&&i.type.indexOf("date")!==0&&i.type!=="time"&&i.type!=="month"){h=i.value.length;i.setSelectionRange(h,h)}else{i.focus()}};g.prototype.updateScrollParent=function(j){var i,h;i=j.fastClickScrollParent;if(!i||!i.contains(j)){h=j;do{if(h.scrollHeight>h.offsetHeight){i=h;j.fastClickScrollParent=h;break}h=h.parentElement}while(h)}if(i){i.fastClickLastScrollTop=i.scrollTop}};g.prototype.getTargetElementFromEventTarget=function(h){if(h.nodeType===Node.TEXT_NODE){return h.parentNode}return h};g.prototype.onTouchStart=function(h){var j,k,i;if(h.targetTouches.length>1){return true}j=this.getTargetElementFromEventTarget(h.target);k=h.targetTouches[0];if(c){i=window.getSelection();if(i.rangeCount&&!i.isCollapsed){return true}if(!d){if(k.identifier&&k.identifier===this.lastTouchIdentifier){h.preventDefault();return false}this.lastTouchIdentifier=k.identifier;this.updateScrollParent(j)}}this.trackingClick=true;this.trackingClickStart=h.timeStamp;this.targetElement=j;this.touchStartX=k.pageX;this.touchStartY=k.pageY;if((h.timeStamp-this.lastClickTime)<this.tapDelay){h.preventDefault()}return true};g.prototype.touchHasMoved=function(i){var j=i.changedTouches[0],h=this.touchBoundary;if(Math.abs(j.pageX-this.touchStartX)>h||Math.abs(j.pageY-this.touchStartY)>h){return true}return false};g.prototype.onTouchMove=function(h){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(h.target)||this.touchHasMoved(h)){this.trackingClick=false;this.targetElement=null}return true};g.prototype.findControl=function(h){if(h.control!==undefined){return h.control}if(h.htmlFor){return document.getElementById(h.htmlFor)}return h.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};g.prototype.onTouchEnd=function(h){var i,n,l,j,m,k=this.targetElement;if(!this.trackingClick){return true}if((h.timeStamp-this.lastClickTime)<this.tapDelay){this.cancelNextClick=true;return true}if((h.timeStamp-this.trackingClickStart)>this.tapTimeout){return true}this.cancelNextClick=false;this.lastClickTime=h.timeStamp;n=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(e){m=h.changedTouches[0];k=document.elementFromPoint(m.pageX-window.pageXOffset,m.pageY-window.pageYOffset)||k;k.fastClickScrollParent=this.targetElement.fastClickScrollParent}l=k.tagName.toLowerCase();if(l==="label"){i=this.findControl(k);if(i){this.focus(k);if(a){return false}k=i}}else{if(this.needsFocus(k)){if((h.timeStamp-n)>100||(c&&window.top!==window&&l==="input")){this.targetElement=null;return false}this.focus(k);this.sendClick(k,h);if(!c||l!=="select"){this.targetElement=null;h.preventDefault()}return false}}if(c&&!d){j=k.fastClickScrollParent;if(j&&j.fastClickLastScrollTop!==j.scrollTop){return true}}if(!this.needsClick(k)){h.preventDefault();this.sendClick(k,h)}return false};g.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};g.prototype.onMouse=function(h){if(!this.targetElement){return true}if(h.forwardedTouchEvent){return true}if(!h.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(h.stopImmediatePropagation){h.stopImmediatePropagation()}else{h.propagationStopped=true}h.stopPropagation();h.preventDefault();return false}return true};g.prototype.onClick=function(h){var i;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(h.target.type==="submit"&&h.detail===0){return true}i=this.onMouse(h);if(!i){this.targetElement=null}return i};g.prototype.destroy=function(){var h=this.layer;if(a){h.removeEventListener("mouseover",this.onMouse,true);h.removeEventListener("mousedown",this.onMouse,true);h.removeEventListener("mouseup",this.onMouse,true)}h.removeEventListener("click",this.onClick,true);h.removeEventListener("touchstart",this.onTouchStart,false);h.removeEventListener("touchmove",this.onTouchMove,false);h.removeEventListener("touchend",this.onTouchEnd,false);h.removeEventListener("touchcancel",this.onTouchCancel,false)};g.notNeeded=function(k){var l;var i;var h;var j;if(typeof window.ontouchstart==="undefined"){return true}i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(i){if(a){l=document.querySelector("meta[name=viewport]");if(l){if(l.content.indexOf("user-scalable=no")!==-1){return true}if(i>31&&document.documentElement.scrollWidth<=window.outerWidth){return true}}}else{return true}}if(b){h=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(h[1]>=10&&h[2]>=3){l=document.querySelector("meta[name=viewport]");if(l){if(l.content.indexOf("user-scalable=no")!==-1){return true}if(document.documentElement.scrollWidth<=window.outerWidth){return true}}}}if(k.style.msTouchAction==="none"||k.style.touchAction==="manipulation"){return true}j=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(j>=27){l=document.querySelector("meta[name=viewport]");if(l&&(l.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)){return true}}if(k.style.touchAction==="none"||k.style.touchAction==="manipulation"){return true}return false};g.attach=function(h,i){return new g(h,i)};if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define(function(){return g})}else{if(typeof module!=="undefined"&&module.exports){module.exports=g.attach;module.exports.FastClick=g}else{window.FastClick=g}}}());