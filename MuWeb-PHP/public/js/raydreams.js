(function(a){var b={datasource:{data:[],keyfield:null},headers:[],pageSize:25,currentPageIdx:0,maxPageButtons:10,parentElem:null,data:i,rowNumbers:true,currentSort:null,currentSelection:null,onRowClick:null};function i(o,q){b.parentElem.find("tbody > tr").remove();b.datasource.data=o;b.datasource.keyfield=q;var t=(b.currentPageIdx*b.pageSize)+1;var n=t;for(var r=t-1;r<((b.currentPageIdx+1)*b.pageSize)&&r<o.length;++r){var s=jQuery("<tr></tr>");if(q!=null){s.data("ray-key",o[r][q])}if(b.rowNumbers){s.append("<td>"+(r+1)+"</td>")}var m=(b.rowNumbers)?1:0;for(;m<b.headers.length;++m){var p=b.headers[m].field;var l=jQuery("<td></td>");if(b.headers[m].renderIf!=null&&!b.headers[m].renderIf(o[r])){l.append("&nbsp;");s.append(l);continue}if(b.headers[m].icons!=null&&b.headers[m].icons.length>0){jQuery.each(b.headers[m].icons,function(w,v){var u=jQuery("<span class='glyphicon' aria-hidden='true' />");u.addClass(v.glyph);if(v.handler!=null){l.on("click",null,{handler:v.handler,data:{rowIdx:r,id:o[r][q]}},e)}if(v.data!=null){u.data("ray-data",o[r][v.data])}l.append(u)})}if(p!=null){if(b.headers[m].format!=null){l.append(b.headers[m].format(o[r]))}else{l.append(o[r][p])}}if(jQuery.trim(l.html()).length<1){l.append("&nbsp;")}s.append(l)}s.on("click",null,{rowIdx:r,id:o[r][q]},f);a(b.parentElem).find("table > tbody").append(s);++n}j({start:t,end:n-1,total:o.length})}jQuery.fn.raytable=function(n){b.parentElem=a(this);if(b.parentElem.prop("tagName").toLowerCase()!="div"){alert("Parent element must be a div tag!");return}b.datasource.data=n.datasource.data;b.datasource.keyfield=n.datasource.keyfield;if(n.pagesize!=null&&n.pagesize>0){b.pageSize=n.pagesize}if(n.maxPageButtons!=null&&n.maxPageButtons>0){b.maxPageButtons=n.maxPageButtons}b.rowNumbers=n.rowNumbers;b.onRowClick=n.rowClickHandler;if(n.columns!=null&&n.columns.length>0){b.headers=n.columns}else{var o=b.parentElem.find("thead tr").children();for(var m=0;m<o.length;++m){var l=a(o[m]).data("ray-field");var p=a(o[m]).text();b.headers.push({field:l,title:p})}}if(b.rowNumbers){n.columns.unshift({field:"rowNum",title:"Row"})}k();i(b.datasource.data,b.datasource.keyfield);j();return b};function k(){var l=jQuery('<table class="table table-striped table-bordered" style="margin-bottom:0px;"><thead><tr></tr></thead><tbody></tbody></table>');jQuery.each(b.headers,function(o,n){var m=jQuery("<th>"+n.title+"</th>");if(n.width!=undefined){m.css("width",n.width+"px")}if(n.sort){var p=jQuery("<span class='glyphicon glyphicon-sort-by-attributes' style='color:LightGray' aria-hidden='true' />");m.append("&nbsp;");m.append(p);p.on("click",null,n.field,g)}l.find("tr").append(m)});b.parentElem.append(l);b.parentElem.append('<div id="raytable-footer" style="padding:5px;"><span id="raytable-footer-summary" style="float:right;">0 - 0 of 0 items</span></div>')}function j(s){if(!s){return}b.parentElem.find("#raytable-footer").empty();b.parentElem.find("#raytable-footer-summary").text(s.start+" - "+s.end+" of "+s.total+" items");var r=jQuery('<ul class="pagination pagination-sm" id="raytable-footer-pager" style="margin-top:0px;"></ul>');b.parentElem.find("#raytable-footer").append(r);if(s.total>b.pageSize){var p=Math.ceil(s.total/b.pageSize);if(b.maxPageButtons<2){b.maxPageButtons=2}if(b.maxPageButtons>p){b.maxPageButtons=p}var t=b.currentPageIdx-Math.floor(b.maxPageButtons/2);if(t<0){t=0}if(p-t<b.maxPageButtons){t=p-b.maxPageButtons}var m=jQuery('<li><a href="#" data="0" aria-label="Previous">&laquo;</a></li>');m.on("click",c);r.append(m);var q=0;for(q=t;q<t+b.maxPageButtons&&q*b.pageSize<s.total;++q){var o=(q==b.currentPageIdx)?jQuery('<li class="active"></li>'):jQuery("<li></li>");var l=jQuery('<a href="#" data="'+q+'">'+(q+1)+"</a>");o.append(l);l.on("click",c);r.append(o)}var n=jQuery('<li><a href="#" data="'+(p-1)+'" aria-label="Next">&raquo;</a></li>');n.on("click",c);r.append(n)}var u='<span id="raytable-footer-summary" style="float:right;">'+s.start+" - "+s.end+" of "+s.total+" items</span>";b.parentElem.find("#raytable-footer").append(u)}function c(m){var l=jQuery(m.target);var n=parseInt(l.attr("data"));b.currentPageIdx=n;i(b.datasource.data,b.datasource.keyfield)}function e(l){l.stopPropagation();var m=l.data.handler;b.currentSelection=l.data.data;l.data=l.data.data;m(l)}function f(l){b.currentSelection=l.data;b.onRowClick(l)}function g(l){if(b.currentSort==null){b.currentSort={field:l.data,direction:1}}else{if(b.currentSort.field!=l.data){b.currentSort={field:l.data,direction:b.currentSort.direction}}else{b.currentSort={field:l.data,direction:b.currentSort.direction*-1}}}b.datasource.data.sort(h(l.data));b.currentPageIdx=0;i(b.datasource.data,b.datasource.keyfield);if(b.currentSort.direction>0){b.parentElem.find("thead th span").each(function(n,m){jQuery(m).removeClass("glyphicon-sort-by-attributes-alt");jQuery(m).addClass("glyphicon-sort-by-attributes");jQuery(m).css("color","LightGray")})}else{b.parentElem.find("thead th span").each(function(n,m){jQuery(m).removeClass("glyphicon-sort-by-attributes");jQuery(m).addClass("glyphicon-sort-by-attributes-alt");jQuery(m).css("color","LightGray")})}jQuery(l.target).css("color","Black")}function h(l){var m=b.currentSort.direction;return function(n,o){var p=(n[l]<o[l])?-1:(n[l]>o[l])?1:0;return p*m}}function d(l){alert("Debugging")}}(jQuery));